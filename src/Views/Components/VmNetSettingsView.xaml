<UserControl xmlns:properties="clr-namespace:ExHyperV.Properties" x:Class="ExHyperV.Views.Components.VmNetSettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:vm="clr-namespace:ExHyperV.ViewModels"
             xmlns:models="clr-namespace:ExHyperV.Models"
             xmlns:converters="clr-namespace:ExHyperV.Converters"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             mc:Ignorable="d" 
             d:DesignHeight="1600" d:DesignWidth="1000"
             d:DataContext="{d:DesignInstance vm:VirtualMachinesPageViewModel}">

    <UserControl.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVis" />
        <converters:IntListToStringConverter x:Key="IntListConverter"/>
        <converters:VlanModeToVisibilityConverter x:Key="VlanModeToVisibilityConverter"/>

        <x:Array x:Key="BandwidthPresets" Type="sys:String">
            <sys:String>0</sys:String>
            <sys:String>10</sys:String>
            <sys:String>100</sys:String>
            <sys:String>1000</sys:String>
            <sys:String>2500</sys:String>
            <sys:String>10000</sys:String>
        </x:Array>

        <x:Array x:Key="StormLimitPresets" Type="sys:String">
            <sys:String>0</sys:String>
            <sys:String>10</sys:String>
            <sys:String>50</sys:String>
            <sys:String>100</sys:String>
            <sys:String>500</sys:String>
            <sys:String>1000</sys:String>
        </x:Array>

        <Style x:Key="SectionBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="{ui:ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="BorderBrush" Value="{ui:ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20,16"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <Style x:Key="SectionHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
            <Setter Property="Margin" Value="4,0,0,8"/>
        </Style>

        <Style x:Key="DescriptionTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{ui:ThemeResource TextFillColorTertiaryBrush}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 页面标题栏 -->
        <Grid Grid.Row="0" Margin="24,16,24,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="{x:Static properties:Resources.Label_NetSettings}" FontSize="20" FontWeight="Normal" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <ui:Button Icon="{ui:SymbolIcon Symbol=Add24}" Content="{x:Static properties:Resources.Button_Add}" Appearance="Primary" Margin="0,0,12,0" Command="{Binding AddNetworkAdapterCommand}"/>
                <ui:Button Appearance="Transparent" Command="{Binding GoBackToDashboardCommand}">
                    <ui:SymbolIcon Symbol="ArrowLeft24" FontSize="18"/>
                </ui:Button>
            </StackPanel>
        </Grid>

        <ProgressBar Grid.Row="1" IsIndeterminate="True" Height="2" Visibility="{Binding IsLoadingSettings, Converter={StaticResource BoolToVis}}"/>

        <ScrollViewer Grid.Row="2" Padding="24,8,24,24" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding SelectedVm.NetworkAdapters}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:VmNetworkAdapter}">
                        <ui:CardExpander Margin="0,0,0,6" IsExpanded="true" ContentPadding="12" Padding="12,8">
                            <ui:CardExpander.Header>
                                <Grid MinHeight="45">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ui:FontIcon Glyph="&#xE839;" FontFamily="{StaticResource SegoeFluentIcons}" FontSize="24" Margin="0,0,16,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="Normal"/>
                                        <ui:ToggleSwitch IsChecked="{Binding IsConnected, Mode=TwoWay}" Margin="24,0,0,0"
                                                         Command="{Binding DataContext.UpdateAdapterConnectionCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                         CommandParameter="{Binding}"/>
                                    </StackPanel>
                                    <ui:Button Grid.Column="2" 
                                   Icon="{ui:SymbolIcon Symbol=Delete24}" 
                                   Appearance="Secondary"
                                   Margin="0,0,16,0" 
                                   Command="{Binding DataContext.RemoveNetworkAdapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                   CommandParameter="{Binding Id}"/>
                                </Grid>
                            </ui:CardExpander.Header>

                            <StackPanel>
                                <!-- 1. 基础连接 -->
                                <TextBlock Text="{x:Static properties:Resources.Label_BasicConnection}" Style="{StaticResource SectionHeaderTextStyle}"/>
                                <Border Style="{StaticResource SectionBorderStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="{x:Static properties:Resources.Menu_NetSwitch}" VerticalAlignment="Center" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                        <ComboBox Grid.Column="1" Margin="0,0,0,12"
                                                  SelectedValue="{Binding SwitchName, Mode=TwoWay}"
                                                  ItemsSource="{Binding DataContext.AvailableSwitchNames, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  IsEnabled="{Binding IsConnected}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="SelectionChanged">
                                                    <i:InvokeCommandAction Command="{Binding DataContext.UpdateAdapterConnectionCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </ComboBox>

                                        <TextBlock Grid.Row="1" Text="{x:Static properties:Resources.Label_MacAddress}" VerticalAlignment="Center" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                        <ui:Button Grid.Row="1" Grid.Column="1" Appearance="Transparent" Margin="0,0,0,12" HorizontalAlignment="Left"
                                                   Command="{Binding DataContext.CopyToClipboardCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                   CommandParameter="{Binding MacAddress}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding MacAddress}" FontFamily="Consolas" FontSize="13"/>
                                                <ui:SymbolIcon Symbol="Copy24" FontSize="12" Margin="8,0,0,0" Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"/>
                                            </StackPanel>
                                        </ui:Button>

                                        <TextBlock Grid.Row="2" Text="{x:Static properties:Resources.Label_IpAddress}" VerticalAlignment="Top" Margin="0,5,0,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                        <ItemsControl Grid.Row="2" Grid.Column="1" ItemsSource="{Binding IpAddresses}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <ui:Button Appearance="Transparent" Margin="0,0,0,4" HorizontalAlignment="Left"
                                                               Command="{Binding DataContext.CopyToClipboardCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding}" FontFamily="Consolas" FontSize="13"/>
                                                            <ui:SymbolIcon Symbol="Copy24" FontSize="12" Margin="8,0,0,0" Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"/>
                                                        </StackPanel>
                                                    </ui:Button>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </Grid>
                                </Border>

                                <!-- 2. VLAN 与 隔离 -->
                                <!-- 2. VLAN 与 隔离 -->
                                <TextBlock Text="{x:Static properties:Resources.Label_VlanIsolate}" Style="{StaticResource SectionHeaderTextStyle}"/>
                                <Border Style="{StaticResource SectionBorderStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <!-- 模式标签 -->
                                            <ColumnDefinition Width="Auto"/>
                                            <!-- 模式下拉框 -->
                                            <ColumnDefinition Width="*"/>
                                            <!-- 参数动态面板 (左对齐) -->
                                            <ColumnDefinition Width="Auto"/>
                                            <!-- 应用按钮 -->
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Text="{x:Static properties:Resources.Label_Mode}" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>

                                        <!-- 减少模式宽度: 140 -> 110 -->
                                        <ComboBox Grid.Column="1" Width="110" 
                  ItemsSource="{Binding DataContext.VlanModeOptions, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                  SelectedValue="{Binding VlanMode, Mode=TwoWay}"
                  DisplayMemberPath="Name"
                  SelectedValuePath="Value"
                  Margin="0,0,16,0"/>

                                        <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">

                                            <!-- Access 模式 -->
                                            <StackPanel Orientation="Horizontal" Visibility="{Binding VlanMode, Converter={StaticResource VlanModeToVisibilityConverter}, ConverterParameter=Access}">
                                                <TextBlock Text="VLAN ID" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <ui:TextBox Text="{Binding AccessVlanId, Mode=TwoWay}" Width="70" VerticalAlignment="Center"/>
                                            </StackPanel>

                                            <!-- Trunk 模式 -->
                                            <StackPanel Orientation="Horizontal" Visibility="{Binding VlanMode, Converter={StaticResource VlanModeToVisibilityConverter}, ConverterParameter=Trunk}">
                                                <TextBlock Text="{x:Static properties:Resources.Label_NativeVlan}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <ui:TextBox Text="{Binding NativeVlanId, Mode=TwoWay}" Width="70" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="{x:Static properties:Resources.Label_AllowList}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <ui:TextBox Text="{Binding TrunkAllowedVlanIds, Converter={StaticResource IntListConverter}, Mode=TwoWay}" Width="160" PlaceholderText="10, 20..." VerticalAlignment="Center"/>
                                            </StackPanel>

                                            <!-- Private VLAN 模式 -->
                                            <StackPanel Orientation="Horizontal" Visibility="{Binding VlanMode, Converter={StaticResource VlanModeToVisibilityConverter}, ConverterParameter=Private}">
                                                <TextBlock Text="{x:Static properties:Resources.Label_Type}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <!-- 减少类型宽度: 160 -> 125 -->
                                                <ComboBox ItemsSource="{Binding DataContext.PvlanModeOptions, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                          SelectedValue="{Binding PvlanMode, Mode=TwoWay}" 
                          DisplayMemberPath="Name"
                          SelectedValuePath="Value"
                          Width="125" Margin="0,0,12,0" VerticalAlignment="Center"/>

                                                <TextBlock Text="{x:Static properties:Resources.Label_PrimaryId}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <ui:TextBox Text="{Binding PvlanPrimaryId, Mode=TwoWay}" Width="65" Margin="0,0,12,0" VerticalAlignment="Center"/>

                                                <TextBlock Text="{x:Static properties:Resources.Label_SecondaryId}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <ui:TextBox Text="{Binding PvlanSecondaryId, Mode=TwoWay}" Width="65" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <ui:Button Grid.Column="3" Content="{x:Static properties:Resources.Button_Apply}" Appearance="Primary" Width="60" 
                   Command="{Binding DataContext.ApplyVlanSettingsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                   CommandParameter="{Binding}"/>
                                    </Grid>
                                </Border>
                                
                                <!-- 3. 流量控制 (QoS) -->
                                <TextBlock Text="{x:Static properties:Resources.Label_Qos}" Style="{StaticResource SectionHeaderTextStyle}"/>
                                <Border Style="{StaticResource SectionBorderStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="24"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{x:Static properties:Resources.Label_Limit}" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                        <ComboBox Grid.Column="1" Width="110" IsEditable="True" Text="{Binding BandwidthLimit, Mode=TwoWay}" ItemsSource="{StaticResource BandwidthPresets}"/>
                                        <TextBlock Grid.Column="3" Text="{x:Static properties:Resources.Label_Reserve}" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                        <ComboBox Grid.Column="4" Width="110" IsEditable="True" Text="{Binding BandwidthReservation, Mode=TwoWay}" ItemsSource="{StaticResource BandwidthPresets}"/>
                                        <ui:Button Grid.Column="6" Content="{x:Static properties:Resources.Button_Apply}" Appearance="Primary" Width="60" Command="{Binding DataContext.ApplyQosSettingsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                    </Grid>
                                </Border>

                                <!-- 4. 硬件加速 (自动保存) -->
                                <TextBlock Text="{x:Static properties:Resources.Label_Offload}" Style="{StaticResource SectionHeaderTextStyle}"/>
                                <Border Style="{StaticResource SectionBorderStyle}" Padding="0">
                                    <StackPanel>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_Sriov}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_Sriov}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding SriovEnabled, Mode=TwoWay}" Command="{Binding DataContext.ToggleOffloadSettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                        <Rectangle Height="1" Fill="{ui:ThemeResource CardStrokeColorDefaultBrush}" Margin="20,0"/>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_Vmq}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_Vmq}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding VmqEnabled, Mode=TwoWay}" Command="{Binding DataContext.ToggleOffloadSettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                        <Rectangle Height="1" Fill="{ui:ThemeResource CardStrokeColorDefaultBrush}" Margin="20,0"/>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_Ipsec}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_Ipsec}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding IpsecOffloadEnabled, Mode=TwoWay}" Command="{Binding DataContext.ToggleOffloadSettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- 5. 安全与监控 -->
                                <TextBlock Text="{x:Static properties:Resources.Label_Security}" Style="{StaticResource SectionHeaderTextStyle}"/>
                                <Border Style="{StaticResource SectionBorderStyle}" Padding="0">
                                    <StackPanel>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_MacSpoof}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_MacSpoof}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding MacSpoofingAllowed, Mode=TwoWay}" Command="{Binding DataContext.ToggleSecuritySettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                        <Rectangle Height="1" Fill="{ui:ThemeResource CardStrokeColorDefaultBrush}" Margin="20,0"/>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_DhcpGuard}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_DhcpGuard}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding DhcpGuardEnabled, Mode=TwoWay}" Command="{Binding DataContext.ToggleSecuritySettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                        <Rectangle Height="1" Fill="{ui:ThemeResource CardStrokeColorDefaultBrush}" Margin="20,0"/>
                                        <Grid Margin="20,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{x:Static properties:Resources.Label_RouterGuard}"/>
                                                <TextBlock Text="{x:Static properties:Resources.Desc_RouterGuard}" Style="{StaticResource DescriptionTextStyle}"/>
                                            </StackPanel>
                                            <ui:ToggleSwitch Grid.Column="1" IsChecked="{Binding RouterGuardEnabled, Mode=TwoWay}" Command="{Binding DataContext.ToggleSecuritySettingCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>

                                        <Rectangle Height="1" Fill="{ui:ThemeResource CardStrokeColorDefaultBrush}" Margin="20,0"/>

                                        <Grid Margin="20,16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="{x:Static properties:Resources.Label_PortMirror}" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                            <ComboBox Grid.Column="1" Width="140" 
          ItemsSource="{Binding DataContext.PortMirroringOptions, RelativeSource={RelativeSource AncestorType=UserControl}}" 
          SelectedValue="{Binding MonitorMode, Mode=TwoWay}"
          DisplayMemberPath="Name"
          SelectedValuePath="Value"/>
                                            <TextBlock Grid.Column="3" Text="{x:Static properties:Resources.Label_StormLimit}" VerticalAlignment="Center" Margin="0,0,12,0" Foreground="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
                                            <ComboBox Grid.Column="4" IsEditable="True" Width="100" Text="{Binding StormLimit, Mode=TwoWay}" ItemsSource="{StaticResource StormLimitPresets}"/>

                                            <ui:Button Grid.Column="6" Content="{x:Static properties:Resources.Button_Apply}" Appearance="Primary" Width="60" Command="{Binding DataContext.ApplySecuritySettingsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ui:CardExpander>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>